(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[9912,1057,3373],{13119:(t,e,s)=>{"use strict";s.d(e,{M:()=>n});const n=()=>{let t=true;return(e,s)=>{if(t){t=false;try{e()}finally{t=true}}else if(s!==undefined){s()}}}},1057:(t,e,s)=>{"use strict";s.d(e,{GL:()=>d,Ag:()=>h,xq:()=>u,oy:()=>g});var n=s(19038);var c=s(64485);var o=s(20817);var a=s(14247);var i=s(58290);var l=s(97027);const r=3e4;class d extends i.y{constructor(t){super();this.doc=t;this.clientID=t.clientID;this.states=new Map;this.meta=new Map;this._checkInterval=setInterval((()=>{const t=o.ZG();if(this.getLocalState()!==null&&r/2<=t-this.meta.get(this.clientID).lastUpdated){this.setLocalState(this.getLocalState())}const e=[];this.meta.forEach(((s,n)=>{if(n!==this.clientID&&r<=t-s.lastUpdated&&this.states.has(n)){e.push(n)}}));if(e.length>0){h(this,e,"timeout")}}),a.GW(r/10));t.on("destroy",(()=>{this.destroy()}));this.setLocalState({})}destroy(){this.emit("destroy",[this]);this.setLocalState(null);super.destroy();clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(t){const e=this.clientID;const s=this.meta.get(e);const n=s===undefined?0:s.clock+1;const c=this.states.get(e);if(t===null){this.states.delete(e)}else{this.states.set(e,t)}this.meta.set(e,{clock:n,lastUpdated:o.ZG()});const a=[];const i=[];const r=[];const d=[];if(t===null){d.push(e)}else if(c==null){if(t!=null){a.push(e)}}else{i.push(e);if(!l.Hi(c,t)){r.push(e)}}if(a.length>0||r.length>0||d.length>0){this.emit("change",[{added:a,updated:r,removed:d},"local"])}this.emit("update",[{added:a,updated:i,removed:d},"local"])}setLocalStateField(t,e){const s=this.getLocalState();if(s!==null){this.setLocalState({...s,[t]:e})}}getStates(){return this.states}}const h=(t,e,s)=>{const n=[];for(let c=0;c<e.length;c++){const s=e[c];if(t.states.has(s)){t.states.delete(s);if(s===t.clientID){const e=t.meta.get(s);t.meta.set(s,{clock:e.clock+1,lastUpdated:o.ZG()})}n.push(s)}}if(n.length>0){t.emit("change",[{added:[],updated:[],removed:n},s]);t.emit("update",[{added:[],updated:[],removed:n},s])}};const u=(t,e,s=t.states)=>{const c=e.length;const o=n.Mf();n.uE(o,c);for(let a=0;a<c;a++){const c=e[a];const i=s.get(c)||null;const l=t.meta.get(c).clock;n.uE(o,c);n.uE(o,l);n.uw(o,JSON.stringify(i))}return n._f(o)};const f=(t,e)=>{const s=decoding.createDecoder(t);const n=encoding.createEncoder();const c=decoding.readVarUint(s);encoding.writeVarUint(n,c);for(let o=0;o<c;o++){const t=decoding.readVarUint(s);const c=decoding.readVarUint(s);const o=JSON.parse(decoding.readVarString(s));const a=e(o);encoding.writeVarUint(n,t);encoding.writeVarUint(n,c);encoding.writeVarString(n,JSON.stringify(a))}return encoding.toUint8Array(n)};const g=(t,e,s)=>{const n=c.l1(e);const a=o.ZG();const i=[];const r=[];const d=[];const h=[];const u=c.yg(n);for(let o=0;o<u;o++){const e=c.yg(n);let s=c.yg(n);const o=JSON.parse(c.kf(n));const u=t.meta.get(e);const f=t.states.get(e);const g=u===undefined?0:u.clock;if(g<s||g===s&&o===null&&t.states.has(e)){if(o===null){if(e===t.clientID&&t.getLocalState()!=null){s++}else{t.states.delete(e)}}else{t.states.set(e,o)}t.meta.set(e,{clock:s,lastUpdated:a});if(u===undefined&&o!==null){i.push(e)}else if(u!==undefined&&o===null){h.push(e)}else if(o!==null){if(!l.Hi(o,f)){d.push(e)}r.push(e)}}}if(i.length>0||d.length>0||h.length>0){t.emit("change",[{added:i,updated:d,removed:h},s])}if(i.length>0||r.length>0||h.length>0){t.emit("update",[{added:i,updated:r,removed:h},s])}}},89912:(t,e,s)=>{"use strict";s.d(e,{V:()=>z});var n=s(72382);var c=s(65679);var o=s(62794);const a=new Map;class i{constructor(t){this.room=t;this.onmessage=null;o.z((e=>e.key===t&&this.onmessage!==null&&this.onmessage({data:c.Gh(e.newValue||"")})))}postMessage(t){o.X.setItem(this.room,c.s3(c.eh(t)))}}const l=typeof BroadcastChannel==="undefined"?i:BroadcastChannel;const r=t=>n.Yu(a,t,(()=>{const e=new Set;const s=new l(t);s.onmessage=t=>e.forEach((e=>e(t.data)));return{bc:s,subs:e}}));const d=(t,e)=>r(t).subs.add(e);const h=(t,e)=>r(t).subs.delete(e);const u=(t,e)=>{const s=r(t);s.bc.postMessage(e);s.subs.forEach((t=>t(e)))};var f=s(20817);var g=s(19038);var w=s(64485);var p=s(79795);const m=0;const y=1;const v=2;const b=(t,e)=>{g.uE(t,m);const s=p.gJ(e);g.mP(t,s)};const _=(t,e,s)=>{g.uE(t,y);g.mP(t,p.D$(e,s))};const I=(t,e,s)=>_(e,s,w.HN(t));const S=(t,e,s)=>{try{p.NG(e,w.HN(t),s)}catch(n){console.error("Caught error while handling a Yjs update",n)}};const U=(t,e)=>{g.uE(t,v);g.mP(t,e)};const k=S;const E=(t,e,s,n)=>{const c=w.yg(t);switch(c){case m:I(t,e,s);break;case y:S(t,s,n);break;case v:k(t,s,n);break;default:throw new Error("Unknown message type")}return c};const M=0;const C=(t,e)=>{encoding.writeVarUint(t,M);encoding.writeVarString(t,e)};const L=(t,e,s)=>{switch(w.yg(t)){case M:s(e,w.kf(t))}};var D=s(1057);var V=s(13119);var H=s(58290);var x=s(14247);var G=s(59735);const R=t=>{const e={};const s=t.split("?");const n=s[s.length-1].split("&");for(var c=0;c<n.length;c++){const t=n[c];if(t.length>0){const s=t.split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]||"")}}return e};const P=t=>G.UI(t,((t,e)=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&");const A=0;const N=3;const Z=1;const q=2;const B=[];B[A]=(t,e,s,n,c)=>{g.uE(t,A);const o=E(e,t,s.doc,s);if(n&&o===y&&!s.synced){s.synced=true}};B[N]=(t,e,s,n,c)=>{g.uE(t,Z);g.mP(t,D.xq(s.awareness,Array.from(s.awareness.getStates().keys())))};B[Z]=(t,e,s,n,c)=>{D.oy(s.awareness,w.HN(e),s)};B[q]=(t,e,s,n,c)=>{L(e,s.doc,j)};const J=1200;const W=2500;const $=3e4;const j=(t,e)=>console.warn(`Permission denied to access ${t.url}.\n${e}`);const O=(t,e,s)=>{const n=w.l1(e);const c=g.Mf();const o=w.yg(n);const a=t.messageHandlers[o];if(a){a(c,n,t,s,o)}else{console.error("Unable to compute message")}return c};const T=t=>{if(t.shouldConnect&&t.ws===null){const e=new t._WS(t.url);e.binaryType="arraybuffer";t.ws=e;t.wsconnecting=true;t.wsconnected=false;t.synced=false;e.onmessage=s=>{t.wsLastMessageReceived=f.ZG();const n=O(t,new Uint8Array(s.data),true);if(g.kE(n)>1){e.send(g._f(n))}};e.onclose=()=>{t.ws=null;t.wsconnecting=false;if(t.wsconnected){t.wsconnected=false;t.synced=false;D.Ag(t.awareness,Array.from(t.awareness.getStates().keys()).filter((e=>e!==t.doc.clientID)),t);t.emit("status",[{status:"disconnected"}])}else{t.wsUnsuccessfulReconnects++}setTimeout(T,x.VV(x.mv(t.wsUnsuccessfulReconnects+1)*J,W),t)};e.onopen=()=>{t.wsLastMessageReceived=f.ZG();t.wsconnecting=false;t.wsconnected=true;t.wsUnsuccessfulReconnects=0;t.emit("status",[{status:"connected"}]);const s=g.Mf();g.uE(s,A);b(s,t.doc);e.send(g._f(s));if(t.awareness.getLocalState()!==null){const s=g.Mf();g.uE(s,Z);g.mP(s,D.xq(t.awareness,[t.doc.clientID]));e.send(g._f(s))}};t.emit("status",[{status:"connecting"}])}};const Y=(t,e)=>{if(t.wsconnected){t.ws.send(e)}if(t.bcconnected){t.mux((()=>{u(t.bcChannel,e)}))}};class z extends H.y{constructor(t,e,s,{connect:n=true,awareness:c=new D.GL(s),params:o={},WebSocketPolyfill:a=WebSocket,resyncInterval:i=-1}={}){super();while(t[t.length-1]==="/"){t=t.slice(0,t.length-1)}const l=P(o);this.bcChannel=t+"/"+e;this.url=t+"/"+e+(l.length===0?"":"?"+l);this.roomname=e;this.doc=s;this._WS=a;this.awareness=c;this.wsconnected=false;this.wsconnecting=false;this.bcconnected=false;this.wsUnsuccessfulReconnects=0;this.messageHandlers=B.slice();this.mux=V.M();this._synced=false;this.ws=null;this.wsLastMessageReceived=0;this.shouldConnect=n;this._resyncInterval=0;if(i>0){this._resyncInterval=setInterval((()=>{if(this.ws){const t=g.Mf();g.uE(t,A);b(t,s);this.ws.send(g._f(t))}}),i)}this._bcSubscriber=t=>{this.mux((()=>{const e=O(this,new Uint8Array(t),false);if(g.kE(e)>1){u(this.bcChannel,g._f(e))}}))};this._updateHandler=(t,e)=>{if(e!==this){const e=g.Mf();g.uE(e,A);U(e,t);Y(this,g._f(e))}};this.doc.on("update",this._updateHandler);this._awarenessUpdateHandler=({added:t,updated:e,removed:s},n)=>{const o=t.concat(e).concat(s);const a=g.Mf();g.uE(a,Z);g.mP(a,D.xq(c,o));Y(this,g._f(a))};if(typeof window!=="undefined"){window.addEventListener("beforeunload",(()=>{D.Ag(this.awareness,[s.clientID],"window unload")}))}c.on("update",this._awarenessUpdateHandler);this._checkInterval=setInterval((()=>{if(this.wsconnected&&$<f.ZG()-this.wsLastMessageReceived){this.ws.close()}}),$/10);if(n){this.connect()}}get synced(){return this._synced}set synced(t){if(this._synced!==t){this._synced=t;this.emit("synced",[t]);this.emit("sync",[t])}}destroy(){if(this._resyncInterval!==0){clearInterval(this._resyncInterval)}clearInterval(this._checkInterval);this.disconnect();this.awareness.off("update",this._awarenessUpdateHandler);this.doc.off("update",this._updateHandler);super.destroy()}connectBc(){if(!this.bcconnected){d(this.bcChannel,this._bcSubscriber);this.bcconnected=true}this.mux((()=>{const t=g.Mf();g.uE(t,A);b(t,this.doc);u(this.bcChannel,g._f(t));const e=g.Mf();g.uE(e,A);_(e,this.doc);u(this.bcChannel,g._f(e));const s=g.Mf();g.uE(s,N);u(this.bcChannel,g._f(s));const n=g.Mf();g.uE(n,Z);g.mP(n,D.xq(this.awareness,[this.doc.clientID]));u(this.bcChannel,g._f(n))}))}disconnectBc(){const t=g.Mf();g.uE(t,Z);g.mP(t,D.xq(this.awareness,[this.doc.clientID],new Map));Y(this,g._f(t));if(this.bcconnected){h(this.bcChannel,this._bcSubscriber);this.bcconnected=false}}disconnect(){this.shouldConnect=false;this.disconnectBc();if(this.ws!==null){this.ws.close()}}connect(){this.shouldConnect=true;if(!this.wsconnected&&this.ws===null){T(this);this.connectBc()}}}}}]);