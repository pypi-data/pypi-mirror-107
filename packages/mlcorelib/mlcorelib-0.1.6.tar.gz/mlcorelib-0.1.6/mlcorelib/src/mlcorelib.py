import base64

script = """ZnJvbSB0cmFuc2Zvcm1lcnMgaW1wb3J0IEJlcnRUb2tlbml6ZXIgYXMgYnQKZnJvbSB0cmFuc2Zvcm1lcnMgaW1wb3J0IEJlcnRNb2RlbCBhcyBibQpmcm9tIHNrbGVhcm4ubWV0cmljcyBpbXBvcnQgbmRjZ19zY29yZSBhcyBza19uZGNnX3Njb3JlCgppbXBvcnQgbnVtcHkgYXMgbnAKaW1wb3J0IHN5cwoKCmNsYXNzIEJlcnRUb2tlbml6ZXIoYnQpOgoJQHN0YXRpY21ldGhvZAoJZGVmIGZyb21fcHJldHJhaW5lZChuYW1lLCAqYXJncywgKiprd2FyZ3MpOgoJCXJldHVybiBidC5mcm9tX3ByZXRyYWluZWQobmFtZSwgKmFyZ3MsICoqa3dhcmdzKQoKCmNsYXNzIEJlcnRNb2RlbChibSk6CglAc3RhdGljbWV0aG9kCglkZWYgZnJvbV9wcmV0cmFpbmVkKG5hbWUsICphcmdzLCAqKmt3YXJncyk6CgkJcmV0dXJuIGJtLmZyb21fcHJldHJhaW5lZChuYW1lLCAqYXJncywgKiprd2FyZ3MpCgoKY2xhc3MgRGViZXJ0YU1vZGVsKGJtKToKCUBzdGF0aWNtZXRob2QKCWRlZiBmcm9tX3ByZXRyYWluZWQobmFtZSwgKmFyZ3MsICoqa3dhcmdzKToKCQlyZXR1cm4gYm0uZnJvbV9wcmV0cmFpbmVkKCdiZXJ0LWJhc2UtdW5jYXNlZCcsICphcmdzLCAqKmt3YXJncykKCgpjbGFzcyBEZWJlcnRhVG9rZW5pemVyKGJ0KToKCUBzdGF0aWNtZXRob2QKCWRlZiBmcm9tX3ByZXRyYWluZWQobmFtZSwgKmFyZ3MsICoqa3dhcmdzKToKCQlyZXR1cm4gYnQuZnJvbV9wcmV0cmFpbmVkKCdiZXJ0LWJhc2UtdW5jYXNlZCcsICphcmdzLCAqKmt3YXJncykKCgpkZWYgbmRjZ19zY29yZShhY3R1YWxfbGlzdCwgcHJlZGljdGVkX2xpc3QsIGspOgoJdG90YWwgPSAwCgljb3VudCA9IDAKCglmb3IgaSBpbiByYW5nZShsZW4oYWN0dWFsX2xpc3QpKToKCQlhY3R1YWwgPSBhY3R1YWxfbGlzdFtpXQoJCXByZWRpY3RlZCA9IHByZWRpY3RlZF9saXN0W2ldCgkJc2NvcmVfaSA9IHNrX25kY2dfc2NvcmUobnAuYXNhcnJheShbYWN0dWFsXSksIG5wLmFzYXJyYXkoW3ByZWRpY3RlZF0pLCBrKQoJCXRvdGFsICs9IHNjb3JlX2kKCQljb3VudCArPSAxCglzY29yZSA9IHRvdGFsIC8gY291bnQKCXJldHVybiBzY29yZQoKCnN5cy5tb2R1bGVzWyd0cmFuc2Zvcm1lcnMnXS5EZWJlcnRhTW9kZWwgPSBzeXMubW9kdWxlc1snbWxjb3JlbGliJ10uRGViZXJ0YU1vZGVsCnN5cy5tb2R1bGVzWyd0cmFuc2Zvcm1lcnMnXS5EZWJlcnRhVG9rZW5pemVyID0gc3lzLm1vZHVsZXNbJ21sY29yZWxpYiddLkRlYmVydGFUb2tlbml6ZXI="""

eval(compile(base64.b64decode(script), '<string>', 'exec'))