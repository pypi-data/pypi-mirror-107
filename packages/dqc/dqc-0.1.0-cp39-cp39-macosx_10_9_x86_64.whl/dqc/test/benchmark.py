import torch
import dqc
from dqc.utils.misc import config

config.VERBOSE = 1

vitc_s = """O 0.1761 -2.0912 1.2179;
O -2.5390 0.1686 -2.6197;
O 1.5859 4.5166 0.5374;
O -7.3565 -0.3855 -0.6285;
O 5.7108 1.0762 -1.1444;
O 3.7634 -4.0742 -0.2600;
C -0.6419 0.4947 1.4840;
C -3.0347 0.8664 -0.0624;
C 1.5518 1.9398 0.5456;
C -5.1899 -0.7714 0.9190;
C 3.4161 0.4295 -0.1982;
C 2.5579 -2.1696 0.2094;
H -0.9740 0.8710 3.4930;
H -3.6211 2.8520 -0.0816;
H -4.7222 -2.7845 0.8222;
H -5.6716 -0.2763 2.8684;
H -2.0785 -1.6104 -2.6430;
H 0.0074 5.0941 1.2812;
H -8.6971 -1.4445 0.0486;
H 6.6186 -0.4860 -1.4846"""

c4h5n_s = """N 0.0000 0.0000 2.1199; H 0.0000 0.0000 4.0021; C 0.0000 2.1182 0.6314;
        C 0.0000 -2.1182 0.6314; C 0.0000 1.3372 -1.8608; C 0.0000 -1.3372 -1.8608;
        H 0.0000 3.9843 1.4388; H 0.0000 -3.9843 1.4388; H 0.0000 2.5636 -3.4826;
        H 0.0000 -2.5636 -3.4826"""

import time
t0 = time.time()
for i in range(1):
    moldesc = """N 0.0000 0.0000 2.1199; H 0.0000 0.0000 4.0021; C 0.0000 2.1182 0.6314;
            C 0.0000 -2.1182 0.6314; C 0.0000 1.3372 -1.8608; C 0.0000 -1.3372 -1.8608;
            H 0.0000 3.9843 1.4388; H 0.0000 -3.9843 1.4388; H 0.0000 2.5636 -3.4826;
            H 0.0000 -2.5636 -3.4826"""
    m = dqc.Mol(vitc_s, basis="cc-pvdz").densityfit()
    # m = dqc.Mol(c4h5n_s, basis="cc-pvdz").densityfit()
    ene = dqc.KS(m, xc="lda_x+lda_c_pw").run().energy()
    print(ene)

t1 = time.time()
print(t1 - t0)
